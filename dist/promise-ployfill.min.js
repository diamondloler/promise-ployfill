!function(e,t){"object"==typeof module&&module.exports?module.exports=t(e):"function"==typeof define&&define.amd?define(function(){return t(e)}):t(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(e){var n=function(e){return"function"==typeof e},i="object"==typeof process&&"function"==typeof process.nextTick&&process.nextTick||"function"==typeof setImmediate&&setImmediate||setTimeout,h=function(e){return e&&e instanceof a},r=Object.prototype.toString,t=function(n,r){return function(e){if(h(e))throw new TypeError("the value of "+n+" should not the promise itself");var t=this;i(function(){t.isThenable&&r.call(t,e)})}},o=function(e){return 0==e.length?{}:e.shift()},s=0,a=function(e){if(!n(e))throw new Error("The resolver must be a function");this.uid=s++,this.resolver=e,this.fulfilled=!1,this.rejected=!1,this.isThenable=!1,this.deferreds=[]};return a.prototype.reject=t("reject",function(e){if(this.fulfilled)throw Error("can't not call reject, promise is already fulfilled");this.rejected=!0,this.isThenable=!1;var t=o(this.deferreds);if(!t.onReject)throw new Error("Uncaught (in promise) "+e);t.onReject(e)}),a.prototype.resolve=t("resolve",function(e){if(this.deferreds.length){if(this.rejected)throw Error("can't not call resolve, promise is already rejected");this.fulfilled=!0,this.isThenable=!0;var t=o(this.deferreds),n=t.onResolve&&t.onResolve(e);h(n)?n.then(this.runResolve.bind(this),this.runReject.bind(this)):this.resolve()}}),a.prototype.runResolve=function(e){this.resolve(e)},a.prototype.runReject=function(e){this.reject(e)},a.prototype.then=function(e,t){if(!n(e)&&!n(t))throw new Error('the arguments of "promise.then" can\'t be empty');return this.deferreds.push({onResolve:e||null,onReject:t||null}),this.isThenable=!0,this.resolver&&this.resolver(this.resolve.bind(this),this.reject.bind(this)),this.resolver=null,this},a.prototype.catch=function(e){this.then(null,e)},a.all=function(i){if(Array.isArray(i)){for(var e,n,o=[],t=i.length,r=t,s=!1,f=function(e){c(e,this)},u=function(e){c(e,this,!0)},c=function(e,t,n){if(!s){var r=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return n;return!1}(i,t);if(!1!==r)o[r]=e,l.apply(null,n?[o,!0]:[o])}};t--;)e=i[t],h(e)?e.then(f.bind(e),u.bind(e)):(o[t]=e,l(o));return new a(function(e){n=e})}function l(e,t){r--,!t&&r||(n(e),s=!0)}},a.resolve=function(t){return e=t,"[object Object]"!==r.call(e)||h(t)||"function"!=typeof t.then?h(t)?t:new a(function(e){e(t)}):new a(t.then);var e},a.reject=function(n){return new a(function(e,t){t(n)})},a.race=function(e){if(Array.isArray(e)){for(var t,n,r=function(e){t(e)},i=e.length;i--;)n=e[i],h(n)&&n.then(r,r);return new a(function(e){t=e})}},function(e){if(!n(e))return!1;var t=e.toString();return"native code"===t.slice(t.indexOf("[")+1,t.lastIndexOf("]"))}(e.Promise)&&e.Promise||(e.Promise=a)});
//# sourceMappingURL=promise-ployfill.min.js.map
