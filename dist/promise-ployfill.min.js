!function(e,t){"object"==typeof module&&module.exports?module.exports=t(e):"function"==typeof define&&define.amd?define(function(){return t(e)}):t(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(e){var n=function(e){return"function"==typeof e},o="object"==typeof process&&"function"==typeof process.nextTick&&process.nextTick||"function"==typeof setImmediate&&setImmediate||setTimeout,h=function(e){return e&&e instanceof p},r=Object.prototype.toString,t=function(n,r){return function(e){if(h(e))throw new TypeError("the value of "+n+" should not the promise itself");var t=this;o(function(){t.isThenable&&r.call(t,e)})}},i=function(e){return 0==e.length?{}:e.shift()},a=function(e,t){return function(){e.apply(t,arguments)}},s=0,p=function(e){if(!n(e))throw new Error("The resolver must be a function");this.promiseId=s++,this.resolver=e,this.fulfilled=!1,this.rejected=!1,this.isThenable=!1,this.deferreds=[]};return p.prototype.reject=t("reject",function(e){if(this.fulfilled)throw Error("can't not call reject, promise is already fulfilled");this.rejected=!0,this.isThenable=!1;var t=i(this.deferreds);if(!t.onReject)throw new Error("Uncaught (in promise) "+e);t.onReject(e)}),p.prototype.resolve=t("resolve",function(e){if(this.deferreds.length){if(this.rejected)throw Error("can't not call resolve, promise is already rejected");this.fulfilled=!0,this.isThenable=!0;var t=i(this.deferreds),n=t.onResolve&&t.onResolve(e);h(n)?n.then(a(this.runResolve,this),a(this.runReject,this)):this.resolve()}}),p.prototype.runResolve=function(e){this.resolve(e)},p.prototype.runReject=function(e){this.reject(e)},p.prototype.then=function(e,t){if(!n(e)&&!n(t))throw new Error('the arguments of "promise.then" can\'t be empty');return this.deferreds.push({onResolve:e||null,onReject:t||null}),this.isThenable=!0,this.resolver&&this.resolver(a(this.resolve,this),a(this.reject,this)),this.resolver=null,this},p.prototype.catch=function(e){this.then(null,e)},p.all=function(o){if(Array.isArray(o)){for(var e,n,i=[],t=o.length,r=t,s=!1,f=function(e){c(e,this)},u=function(e){c(e,this,!0)},c=function(e,t,n){if(!s){var r=function(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return n;return!1}(o,t);if(!1!==r)i[r]=e,l.apply(null,n?[i,!0]:[i])}};t--;)e=o[t],h(e)?e.then(a(f,e),a(u,e)):(i[t]=e,l(i));return new p(function(e){n=e})}function l(e,t){r--,!t&&r||(n(e),s=!0)}},p.resolve=function(t){return e=t,"[object Object]"!==r.call(e)||h(t)||"function"!=typeof t.then?h(t)?t:new p(function(e){e(t)}):new p(t.then);var e},p.reject=function(n){return new p(function(e,t){t(n)})},p.race=function(e){if(Array.isArray(e)){for(var t,n,r=function(e){t(e)},o=e.length;o--;)n=e[o],h(n)&&n.then(r,r);return new p(function(e){t=e})}},function(e){if(!n(e))return!1;var t=e.toString();return"native code"===t.slice(t.indexOf("[")+1,t.lastIndexOf("]"))}(e.Promise)&&e.Promise||(e.Promise=p)});
//# sourceMappingURL=promise-ployfill.min.js.map
